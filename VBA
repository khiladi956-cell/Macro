Sub Start_Time()

    Dim ws As Worksheet
    Dim r As Long
    Dim lastRow As Long
    Dim i As Long

    Set ws = ActiveSheet
    r = ActiveCell.Row

    ' ?? Check Broad Step & Step Name (merged safe)
    If Trim(ws.Cells(r, "E").Value) = "" Or _
       Trim(ws.Cells(r, "G").Value) = "" Then
        MsgBox "Please fill Broad Step (E:F) and Step Name (G:K) before START!", vbCritical
        Exit Sub
    End If

    ' ?? Prevent duplicate START on same row
    If ws.Cells(r, "P").Value <> "" Then
        MsgBox "START already recorded for this row!", vbExclamation
        Exit Sub
    End If

    ' ?? GLOBAL validation ? Only ONE active START allowed
    lastRow = ws.Cells(ws.Rows.Count, "P").End(xlUp).Row

    For i = 2 To lastRow
        If ws.Cells(i, "P").Value <> "" And ws.Cells(i, "Q").Value = "" Then
            MsgBox "Another task is already running (Row " & i & "). Please END it first!", vbCritical
            Exit Sub
        End If
    Next i

    ' ?? Record Start Time
    ws.Cells(r, "P").Value = Now
    ws.Cells(r, "P").NumberFormat = "hh:mm:ss"

End Sub


