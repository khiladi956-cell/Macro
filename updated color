Sub Highlight_Running_Row(Optional ByVal ForceRow As Long = 0)

    Dim ws As Worksheet
    Dim r As Long

    Set ws = ActiveSheet

    ' Clear highlight ONLY from non-ended rows
    For r = 19 To 50
        If ws.Cells(r, "S").Value = "" Then
            ws.Range("D" & r & ":U" & r).Interior.ColorIndex = xlNone
        End If
    Next r

    ' ðŸ”´ ABSOLUTE PRIORITY: Ended rows â†’ Grey
    For r = 19 To 50
        If ws.Cells(r, "S").Value <> "" Then
            ws.Range("D" & r & ":U" & r).Interior.ColorIndex = 15
        End If
    Next r

    ' FORCE highlight (Resume case only)
    If ForceRow >= 19 And ForceRow <= 50 Then
        ws.Range("D" & ForceRow & ":U" & ForceRow).Interior.ColorIndex = 35
        Exit Sub
    End If

    ' Detect current active row
    For r = 19 To 50

        ' PAUSED â†’ Orange
        If ws.Cells(r, "R").Value <> "" And ws.Cells(r, "S").Value = "" Then
            ws.Range("D" & r & ":U" & r).Interior.ColorIndex = 45
            Exit For
        End If

        ' RUNNING â†’ Green
        If ws.Cells(r, "P").Value <> "" _
           And ws.Cells(r, "Q").Value = "" _
           And ws.Cells(r, "R").Value = "" _
           And ws.Cells(r, "S").Value = "" Then
            ws.Range("D" & r & ":U" & r).Interior.ColorIndex = 35
            Exit For
        End If

    Next r

End Sub
